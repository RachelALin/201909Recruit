<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<title>启明星成绩查询</title>
	<!-- Meta tag Keywords -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="UTF-8" />
	<meta name="keywords" content="" />
	<script>

		addEventListener("load", function () {
			setTimeout(hideURLbar, 0);
		}, false);

		function hideURLbar() {
			window.scrollTo(0, 1);
		}
	</script>
	<!--// Meta tag Keywords -->
	<!-- Custom-Files -->
	<link rel="stylesheet" th:href="@{/css/bootstrap.css}">
	<!-- Bootstrap-Core-CSS -->
	<link rel="stylesheet" th:href="@{/css/style.css}" type="text/css" media="all" />
	<!-- Style-CSS -->
	<link rel="stylesheet" th:href="@{/css/fontawesome-all.css}">
	<!-- Font-Awesome-Icons-CSS -->
	<!-- //Custom-Files -->
	<link rel="stylesheet" type="text/css" th:href="@{/css/grade.css}">
	<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">

	<script>
		function reg() {
			var studentName = document.getElementById("studentName").value;
			var studentId = document.getElementById("studentId").value;
			var code=document.getElementById("code").value;
			var obj = {
				studentName:studentName,
				studentId:studentId,
				code:code,
			}

			$.ajax({
				"url": "/checkgrade",    //reg是注册接口
				type:'POST',
				dataType:'json',
				contentType:'application/json',
				data: JSON.stringify(obj),
				success: function(result) {
					console.log(result);
					if (result=="1"){
						alert(result);
						return true;
					}else {
						alert("输入有误，无法查询！！！");
						window.location.href="/grade";
						return false;
					}
				},
				error: function (XMLHttpRequest, textStatus, errorThrown) {
					console.log('XMLHttpRequest:');
					console.log(XMLHttpRequest);
					alert('网络异常！尝试刷新网页解决问题')
				}
			});
		}
	</script>
	<script>
		var list = [0,0,0,0];
		function $$1(idName){
			return document.getElementById(idName);
		}

		function checkgradename(obj){
			var reg=/^[\u0391-\uFFE5\·]+$/;
			if(obj==""){
				var mzp = $$1("gradename");
				list[0]=0;
				mzp.innerHTML="姓名不能为空！";
				return false;
			}
			else if(reg.test(obj)!=true){
				var mzp = $$1("gradename");
				list[0]=0;
				mzp.innerHTML="姓名只能为中文（可能输入了空格等非法字符）！";
				return false;
			}
			else {
				var mzp = $$1("gradename");
				list[0]=8;
				mzp.innerHTML="";
				return true;
			}

		}

		function checkgradeid(obj){
			var reg = /^[2][0][1][6-9][0-9]{6}$/;;
			if(obj==""){
				var mzp1 = $$1("gradeid");
				list[1]=0;
				mzp1.innerHTML="学号不能为空！";
				return false;
			}
			else if (reg.test(obj)!=true) {
				var mzp1 = $$1("gradeid");
				list[1]=0;
				mzp1.innerHTML="请输入有效的学号！";
				return false;
			}
			else {
				var mzp1 = $$1("gradeid");
				list[1]=8;
				mzp1.innerHTML="";
				return true;
			}

		}
		function checkgradetel(obj){
			var reg = /^[1][3,5,8,6,9][0,1,2,3,4,5,6,7,8,9][0-9]{8}$/;
			if(obj==""){
				var mzp2 = $$1("gradetel");
				list[2]=0;
				mzp2.innerHTML="电话不能为空！";
				return false;
			}
			else if (reg.test(obj)!=true) {
				var mzp2 = $$1("gradetel");
				list[2]=0;
				mzp2.innerHTML="请输入有效的电话";
				return false;
			}
			else {
				var mzp2 = $$1("gradetel");
				mzp2.innerHTML="";
				list[2]=8;
				return true;
			}

		}

		var trueCode;
		function code(){
			var tel = document.getElementById("ftel").value;
			var studentName= document.getElementById("studentName").value;
			var studentId= document.getElementById("studentId").value;
			var obj = {
				tel:tel,
				studentName:studentName,
				studentId:studentId,
			}
			if(tel==""||studentName==""||studentId==""){
				alert("信息不完整！");
				return false;
			}
			else{
				$.ajax({
					"url": "/getcode",        //login是登录接口
					type: 'POST',
					dataType: 'json',
					contentType: 'application/json',
					data: JSON.stringify(obj),
					success: function (result) {
						if (result=="0") {
							alert("验证码发送失败，请重试！！！");
							return false;
						}else if(result=="2"){
							alert("您未参加考试.")
							return false;
						}else{
							trueCode = result;
							alert("验证码发送成功，请注意查收！！！");
							return true;
						}

					},
					error: function (XMLHttpRequest, textStatus, errorThrown) {
						console.log('XMLHttpRequest:');
						console.log(XMLHttpRequest);
						alert('网络异常！尝试刷新网页解决问题')
					}

				});
			}
		}
		function checkcode(obj) {

			// var code = document.getElementById("code").value;

			var reg = /^[0-9]+$/;

			if (obj == "") {
				var mzp3 = $$1("gradecode");
				list[3] = 0;
				mzp3.innerHTML = "验证码不能为空！";
				return false;
			} else if (reg.test(obj) != true) {
				var mzp3 = $$1("gradecode");
				list[3] = 0;
				mzp3.innerHTML = "验证码只能为数字";
				return false;
			} else if(trueCode != obj ){
				var mzp3 = $$1("gradecode");
				list[3] = 0;
				mzp3.innerHTML = "验证码不正确";
				return false;
			}
			else {

				var mzp3 = $$1("gradecode");
				list[3] = 8;
				mzp3.innerHTML = "";
				return true;
			}
		}

		function checknormal(){
			for(var i = 0 ; i < list.length ; i ++){
				if(list[i]!=8){
					alert("您可能漏填或错填了了某项信息，请仔细查看后再次提交。");
					return false;
				}
			}
			return true;
		}


	</script>

</head>

<body>
	<div class="container">
	<div class="Header" style="border-bottom: 2px solid #195199;">
		<div class="row"> 
			<div class="col-lg-4 col-md-4 col-sm-4">
				<div class="row">
				<img src="https://ae01.alicdn.com/kf/Hfa3262ba7e9f4d1db8cd971784c4ab8fC.png">
				<h3 style="margin-top:50px; color:#195199; font-family: '微软雅黑';"><strong>启明星成绩查询</strong></h3>

				</div> 
				
			</div>

		</div>
	
	</div>
	<div class="container">
	<div class="Content">
		<div class="row" style="margin: 40px auto;">
		<div class="col-md-7 col-sm-7 rightbox" >
			<h4 style="text-align: center; color:#4986d5 ;">2019年秋季启明星成绩查询</h4>
			<br>
			<p style="font-size: 12px; color: #514747; font-family: '宋体'; text-align: center;">仅限于2019年秋季启明星成绩查询</p>
			<br>
			<form action="/dograde" method="post">
			<div class="form-group">
				<div class="row">
				<div class="col-md-1">姓名:</div>
				<div class=" col-md-11 col-sm-11 mb-3 mb-sm-0">
					<input type="text" class="form-control form-control-user" name="studentName" id="studentName" placeholder="输入姓名" onblur=" return checkgradename(this.value)">
					<p id="gradename"></p>
				</div>
				</div>
				<br>
				<div class="row">
				<div class="col-md-1">学号:</div>
				<div class="col-md-11 col-sm-11 mb-3 mb-sm-0">
					<input type="text" class="form-control form-control-user" name="studentId" id="studentId" placeholder="输入学号" onblur="return checkgradeid(this.value)">
					<p id="gradeid"></p>

				</div>

				</div>

				<br>
				<div class="row">
					<div class="col-md-1">号码:</div>
					<div class="col-md-11 col-sm-11 mb-3 mb-sm-0">
						<input type="text" class="form-control form-control-user" name="tel" onblur="return checkgradetel(this.value)" id="ftel" placeholder="输入联系电话" >
						<p id="gradetel"></p>
					</div>
<!--					<div class="col-md-3">输入电话号码:</div>-->
<!--					<div class="col-md-5 col-sm-6 mb-3 mb-sm-0">-->
<!--						<input type="text" class="form-control form-control-user" name="tel" id="ftel" placeholder="">-->
<!--					</div>-->
<!--					<div class="col-md-4 col-sm-6 mb-3 mb-sm-0">-->
<!--						<button type="button" class="btn btn-primary btn-user btn-block" onclick="code()">-->
<!--							获取验证码-->
<!--						</button>-->
<!--					</div>-->


				</div>
				<br>
				<div class="row">
<!--					<div class="col-md-1">输入验证码:</div>-->
					<div class="col-md-3 col-sm-6 mb-3 mb-sm-0">填入验证码</div>

					<div class="col-md-5 col-sm-6 mb-3 mb-sm-0">
						<input type="text" class="form-control form-control-user" onblur="return checkcode(this.value)" name="code" id="code" placeholder="输入验证码">
						<p id="gradecode"></p>
					</div>
					<div class="col-md-4 col-sm-6 mb-3 mb-sm-0">
						<input  type="button" onclick="settime(this)" value="获取验证码">
					</div>
				</div>
			</div>
			<br>
			<button type="submit" class="btn btn-primary btn-user btn-block" onclick="return checknormal();return reg()">
			查询成绩
			</button>
		
			</form>

		</div>
		<hr>

		<div class="col-md-5 col-sm-5">
			<div class="container topbox" >
		<!-- 	<div class="content1" style="margin: 20px 88px;" > -->
					<div class="col-md-5" style="margin: 0 auto;"></div>
					<span class="glyphicon glyphicon-print"></span>
					<p style="font-family: '宋体'; font-size: 14px; color: #766e6e;">若对成绩产生质疑可用以下方式联系我们</p>
		
					<br>
					<ul style="list-style:none;">
						<li style="font-family: '宋体';"><i class="fa fa-phone" style="color: #195199;"></i>&nbsp15871595179</li>
						<br>
						<li style="font-family: '宋体';"><i class="fa fa-envelope" style="color: #195199;"></i>&nbsp361808700@qq.com</li>
						<br>
						<li style="font-family: '宋体';"><i class="fa fa-table" style="color: #195199;"></i>&nbsp工作日
						<br>
						&nbsp&nbsp上午：08:00-11:40 
						<br>
						&nbsp&nbsp下午：13:40-17:40
						<br>
						&nbsp&nbsp晚上：19:00-22:30
						</li>
						<hr>
						<li style="font-family: '宋体';"><a href="/"><i class="fa fa-undo" style="color: #195199;"></i></a>&nbsp回到招新主页</li>
					</ul> 

				
			</div>
			
		</div>
		</div>
	</div>

	</div>
	</div>


	<div class="footer">
		<div class="copy-right-w3ls py-3" style="background: rgba(128, 122, 122, 0.08); ">
			<div class="container" >
	
				<div class="col-md-4 col-sm-12" style="margin: 0 auto;"><p style="text-align: center;">启明星©to make a difference</p></div>

			</div>
		</div>
	</div>
	<!-- Js files -->
	<!-- JavaScript -->
	<script th:src="@{/js/jquery-2.2.3.min.js}"></script>
	<!-- Default-JavaScript-File -->
	<script th:src="@{/js/bootstrap.js}"></script>
	<!-- Necessary-JavaScript-File-For-Bootstrap -->

	<!-- fixed nav -->
	<script>
		$(window).scroll(function () {
			if ($(document).scrollTop() > 50) {
				$('nav').addClass('shrink');
			} else {
				$('nav').removeClass('shrink');
			}
		});
	</script>
	<!-- //fixed nav -->
	<!-- //navigation -->

	<!-- smooth scrolling -->
	<script th:src="@{/js/SmoothScroll.min.js}"></script>
	<!-- move-top -->
	<script th:src="@{/js/move-top.js}"></script>
	<!-- easing -->
	<script th:src="@{/js/easing.js}"></script>
	<!--  necessary snippets for few javascript files -->
	<script th:src="@{/js/outdoor.js}"></script>

	<script th:src="@{/js/bootstrap.js}"></script>
	<!-- Necessary-JavaScript-File-For-Bootstrap -->

	<!-- //Js files -->
	<!--<script type="text/javascript">
		function code(){
			var tel = document.getElementById("ftel").value;
			var obj = {
				tel:tel,
			}
			$.ajax({
				"url": "/getcode",        //login是登录接口
				type: 'POST',
				dataType: 'json',
				contentType: 'application/json',
				data: JSON.stringify(obj),
				success: function (result) {
					if (result=="1") {
						alert("验证码发送成功，请注意查收！！！");
						return true;
					}else {
						alert("验证码发送失败，请重试！！！");
						return false;
					}

				},
				error: function (XMLHttpRequest, textStatus, errorThrown) {
					console.log('XMLHttpRequest:');
					console.log(XMLHttpRequest);
					alert('网络异常！尝试刷新网页解决问题')
				}

			});
		}
	</script>
-->


	<script type="text/javascript">
		//倒计时
		var countdown=60;
		function settime(val) {

			if (countdown == 0) {
				val.removeAttribute("disabled");
				val.value="获取验证码";
				countdown = 60;

				return false;
			}
			else {
				if (countdown == 60){
					if (code()== false){
						countdown==0;
					}
				}
				val.setAttribute("disabled", true);
				val.value="重发(" + countdown + "s)";
				countdown--;
			}
			setTimeout(function() {
				settime(val);
			},1000);
		}
	</script>


</body>

</html>